{"ast":null,"code":"import { loadGame, startBoard } from '../api/gameApi';\nimport customFlag from '../../../assets/images/flag';\nimport fire from '../../../assets/images/fire';\nimport bombs from '../../../assets/images/bomb';\nimport one from '../../../assets/images/one';\nimport two from '../../../assets/images/two';\nimport three from '../../../assets/images/three';\nimport four from '../../../assets/images/four';\nimport five from '../../../assets/images/five';\nimport six from '../../../assets/images/six';\nimport seven from '../../../assets/images/seven';\nimport eight from '../../../assets/images/eight';\nimport { START_GAME_SUCCESS, RESTAR_GAME_SUCCESS, CELL_STATUS, GAME_STATUS_SUCCESS, LOAD_GAME_SUCCESS, GAME_STATUS, GAME_ID_STATUS, PUT_FLAG, UPDATE_GAME, FLIP_CELL, LOAD_BOARD_SUCCESS, NOTHING } from '../constants/actionTypes'; //export function startGameBoardZZ() {\n//console.log(\"estoy en funcion startGameBoard dentro de /actions\");\n//return (startGameSuccess(loadGame()));\n//}\n//export function startGameSuccess() {\n\nexport function startGameBoard() {\n  console.log(\"Estoy en startGameBoard dentro de /actions\"); //console.log(props)\n\n  var boardWithMines = loadGame();\n  console.log(boardWithMines);\n  console.log(\"listo\"); //return function(dispatch) {\n\n  console.log(\"AAAAAAAAAAAAAAAAAAAAAAA\");\n  var data = {\n    board: boardWithMines,\n    game_status: 3,\n    board_status: startBoard(),\n    flipped_boxes: 0\n  };\n  fetch('/game/start', {\n    method: 'POST',\n    body: JSON.stringify(data),\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  }).then(function (response) {\n    return response.json();\n  }).then(function (data) {\n    console.log(\"respuesta del controlador start_game:\");\n    console.log(data); //si recibo data.message == \"Nuevo\", continua el flujo normal\n    //pero si recibo data.message == \"Guardado\"\n    //debo utilizar la respuesta para pintar las banderas\n\n    if (data.message == \"Guardado\") {\n      console.log(\"vamos a recuperar las banderas\");\n      $(\".prueba-componente\").css('background', '#980f8c');\n      var boardStatus = data.board_status;\n      paintFlags(boardStatus);\n    } else {\n      if (data.message == \"Nuevo\") {\n        $(\".prueba-componente\").css('background', '#054bd8');\n        startGameExit(data);\n      }\n    } //startGameExit(data);\n\n  })[\"catch\"](function (error) {\n    return console.log('error', error);\n  }); //}\n}\n\nfunction paintFlags(boardStatus) {\n  console.log(\"Estamos en la funcion que buscara las posicones para colocar banderas\"); //buscar todas las posiciones con bandera y dibujarlas en la pagina\n\n  for (var row = 0; row < 10; row++) {\n    for (var column = 0; column < 10; column++) {\n      if (boardStatus[row][column] == 2) {\n        //colocar una bandera en esa posicion\n        console.log(\"Existe una bandera en la posicion row=\".concat(row, \" column=\").concat(column));\n        var image = new Image(); //image.src= \"packs/media/images/flag-8654d5a5.png\"\n\n        image.src = bombs;\n        console.log(\".cell.\".concat(row).concat(column));\n        $(\".cell.\".concat(row).concat(column)).append(image);\n        $(\".cell.\".concat(row).concat(column)).css('background', '#1636ad');\n      }\n    }\n  }\n\n  return {\n    type: LOAD_GAME_SUCCESS\n  };\n}\n\nfunction startGameExit(data) {\n  console.log(\"ULTIMA FUNCION EN EJECUCION\");\n  return {\n    type: START_GAME_SUCCESS,\n    trash: data\n  };\n}\n\nexport function restartGame() {\n  console.log(\"Estamos en la funcion restartGame\");\n  var boardWithMines = loadGame();\n  console.log(boardWithMines);\n  console.log(\"listo\");\n  return function (dispatch) {\n    console.log(\"despachamos la funcion que ejecutara el fetch\");\n    var data = {\n      board: boardWithMines,\n      game_status: 3,\n      board_status: startBoard(),\n      flipped_boxes: 0\n    };\n    fetch('/game/restart', {\n      method: 'POST',\n      body: JSON.stringify(data),\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).then(function (response) {\n      return response.json();\n    }).then(function (data) {\n      console.log(\"respuesta del controlador reset_game:\");\n      console.log(data);\n      dispatch(restartGameSuccess(data));\n    })[\"catch\"](function (error) {\n      return console.log('error', error);\n    });\n  };\n}\n\nfunction restartGameSuccess(data) {\n  return {\n    type: RESTAR_GAME_SUCCESS,\n    gameId: data.game_id.$oid,\n    gameStatus: data.game_status\n  };\n}\n\nexport function switchFlag(coordinates, validateCellStatus, cell, props) {\n  console.log(\"estamos en la funcion switchFlag\");\n  console.log(coordinates);\n  console.log(validateCellStatus);\n  console.log(cell);\n  return function (dispatch) {\n    var data = {\n      coordinates: coordinates\n    };\n    fetch('/game/flag', {\n      method: 'POST',\n      body: JSON.stringify(data),\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).then(function (response) {\n      return response.json();\n    }).then(function (data) {\n      validateCellStatus(cell, data, props);\n      console.log(\"respuesta del estado de la celda:\");\n      console.log(data.cell_status);\n      dispatch(flagSuccess(data.cell_status));\n    })[\"catch\"](function (error) {\n      return console.log('error', error);\n    });\n  };\n}\n\nfunction flagSuccess(response) {\n  console.log(\"se obtuvo el valor de la celda:\");\n  console.log(response);\n  return {\n    type: CELL_STATUS,\n    cellStatus: response\n  };\n}\n\nexport function knowTheGameState(gameStatus) {\n  if (gameStatus == 3) {\n    console.log(\"Estamos en un juego nuevo, obtener el Id para ir guardando los cambios\");\n    return function (dispatch) {\n      fetch('/game/get/id').then(function (response) {\n        return response.json();\n      }).then(function (data) {\n        console.log(data);\n        dispatch(gameIdSuccess(data));\n      });\n    };\n  } else {\n    if (gameStatus == 0) {\n      console.log(\"ya se estaba jugando, restaurar el tablero guardado\");\n    } else {\n      if (gameStatus == 1) {\n        console.log(\"El jugador ha perdido\");\n      } else {\n        if (gameStatus == 2) {\n          console.log(\"El jugador ha ganado\");\n        }\n      }\n    }\n  }\n\n  return {\n    type: NOTHING\n  };\n}\n\nfunction gameIdSuccess(data) {\n  console.log(\"llegamos a GAMEIDSUCCESS\");\n  return {\n    type: GAME_ID_STATUS,\n    gameId: data.game_id.$oid,\n    gameStatus: data.game_status\n  };\n}\n\nexport function getStatusGame(props) {\n  console.log(\"Estamos en la funcion getStatusGame\");\n  console.log(props);\n  return {\n    type: GAME_STATUS_SUCCESS,\n    data: props //AUN NO SE HA ESCRITO LA RESPUESTA EN STATES.JS\n\n  };\n}\nexport function markTheBoard(gameId, coordinates) {\n  console.log(\"llegamos a markTheBoard\");\n  return function (dispatch) {\n    var data = {\n      gameId: gameId,\n      coordinates: coordinates\n    };\n    fetch('/game/push/flag', {\n      method: 'POST',\n      body: JSON.stringify(data),\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).then(function (response) {\n      return response.json();\n    }).then(function (data) {\n      console.log(\"respuesta del estado de la celda:\");\n      console.log(data);\n      console.log(data.game_status);\n      dispatch(markBoardSuccess(data.game_status));\n    })[\"catch\"](function (error) {\n      return console.log('error', error);\n    });\n  };\n}\n\nfunction markBoardSuccess(gameStatus) {\n  console.log(\"llegamos a markBoardSuccess\");\n  return {\n    type: PUT_FLAG,\n    gameStatus: gameStatus\n  };\n}","map":{"version":3,"sources":["/home/valter/Documents/HOMIE/PROYECTO/Proyect/search-mines/app/javascript/src/actions/actions.js"],"names":["loadGame","startBoard","customFlag","fire","bombs","one","two","three","four","five","six","seven","eight","START_GAME_SUCCESS","RESTAR_GAME_SUCCESS","CELL_STATUS","GAME_STATUS_SUCCESS","LOAD_GAME_SUCCESS","GAME_STATUS","GAME_ID_STATUS","PUT_FLAG","UPDATE_GAME","FLIP_CELL","LOAD_BOARD_SUCCESS","NOTHING","startGameBoard","console","log","boardWithMines","data","board","game_status","board_status","flipped_boxes","fetch","method","body","JSON","stringify","headers","then","response","json","message","$","css","boardStatus","paintFlags","startGameExit","error","row","column","image","Image","src","append","type","trash","restartGame","dispatch","restartGameSuccess","gameId","game_id","$oid","gameStatus","switchFlag","coordinates","validateCellStatus","cell","props","cell_status","flagSuccess","cellStatus","knowTheGameState","gameIdSuccess","getStatusGame","markTheBoard","markBoardSuccess"],"mappings":"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","sourcesContent":["import { loadGame, startBoard } from '../api/gameApi';\nimport customFlag from '../../../assets/images/flag';\nimport fire from '../../../assets/images/fire';\nimport bombs from '../../../assets/images/bomb';\nimport one from '../../../assets/images/one';\nimport two from '../../../assets/images/two';\nimport three from '../../../assets/images/three';\nimport four from '../../../assets/images/four';\nimport five from '../../../assets/images/five';\nimport six from '../../../assets/images/six';\nimport seven from '../../../assets/images/seven';\nimport eight from '../../../assets/images/eight';\nimport {\n  START_GAME_SUCCESS,\n  RESTAR_GAME_SUCCESS,\n  CELL_STATUS,\n  GAME_STATUS_SUCCESS,\n  LOAD_GAME_SUCCESS,\n  GAME_STATUS,\n  GAME_ID_STATUS,\n  PUT_FLAG,\n  UPDATE_GAME,\n  FLIP_CELL,\n  LOAD_BOARD_SUCCESS,\n  NOTHING\n} from '../constants/actionTypes';\n\n//export function startGameBoardZZ() {\n  //console.log(\"estoy en funcion startGameBoard dentro de /actions\");\n  //return (startGameSuccess(loadGame()));\n//}\n\n//export function startGameSuccess() {\nexport function startGameBoard() {\n  console.log(\"Estoy en startGameBoard dentro de /actions\")\n  //console.log(props)\n  var boardWithMines = loadGame()\n  console.log(boardWithMines);\n  console.log(\"listo\")\n  //return function(dispatch) {\n    console.log(\"AAAAAAAAAAAAAAAAAAAAAAA\")\n    let data = {\n      board: boardWithMines,\n      game_status: 3,\n      board_status: startBoard(),\n      flipped_boxes: 0\n    }\n    fetch('/game/start', {\n      method: 'POST',\n      body: JSON.stringify(data),\n      headers: {'Content-Type': 'application/json' }\n    })\n    .then(response => response.json())\n    .then(data => {\n      console.log(\"respuesta del controlador start_game:\");\n      console.log(data);\n      //si recibo data.message == \"Nuevo\", continua el flujo normal\n      //pero si recibo data.message == \"Guardado\"\n      //debo utilizar la respuesta para pintar las banderas\n      if (data.message == \"Guardado\") {\n        console.log(\"vamos a recuperar las banderas\");\n        $(`.prueba-componente`).css('background', '#980f8c');\n        var boardStatus = data.board_status\n        paintFlags(boardStatus)\n      } else {\n        if (data.message == \"Nuevo\") {\n          $(`.prueba-componente`).css('background', '#054bd8');\n          startGameExit(data);\n        }\n      }\n      //startGameExit(data);\n    })\n    .catch(error => console.log('error', error));\n  //}\n}\n\nfunction paintFlags(boardStatus) {\n  console.log(\"Estamos en la funcion que buscara las posicones para colocar banderas\")\n  //buscar todas las posiciones con bandera y dibujarlas en la pagina\n  for (var row = 0; row < 10; row++) {\n    for (var column = 0; column < 10; column++) {\n      if (boardStatus[row][column] == 2) {\n        //colocar una bandera en esa posicion\n        console.log(`Existe una bandera en la posicion row=${row} column=${column}`)\n        var image = new Image();\n        //image.src= \"packs/media/images/flag-8654d5a5.png\"\n        image.src = bombs\n        console.log(`.cell.${row}${column}`)\n        $(`.cell.${row}${column}`).append(image)\n        $(`.cell.${row}${column}`).css('background', '#1636ad');\n      }\n    }\n  }\n  return {\n    type: LOAD_GAME_SUCCESS\n  }\n}\n\nfunction startGameExit(data) {\n  console.log(\"ULTIMA FUNCION EN EJECUCION\")\n  return {\n    type: START_GAME_SUCCESS,\n    trash: data\n  };\n}\n\nexport function restartGame() {\n  console.log(\"Estamos en la funcion restartGame\")\n  var boardWithMines = loadGame()\n  console.log(boardWithMines);\n  console.log(\"listo\")\n  return function(dispatch) {\n    console.log(\"despachamos la funcion que ejecutara el fetch\")\n    let data = {\n      board: boardWithMines,\n      game_status: 3,\n      board_status: startBoard(),\n      flipped_boxes: 0\n    }\n    fetch('/game/restart', {\n      method: 'POST',\n      body: JSON.stringify(data),\n      headers: {'Content-Type': 'application/json' }\n    })\n    .then(response => response.json())\n    .then(data => {\n      console.log(\"respuesta del controlador reset_game:\");\n      console.log(data);\n      dispatch(restartGameSuccess(data));\n    })\n    .catch(error => console.log('error', error));\n  }\n}\n\nfunction restartGameSuccess(data) {\n  return {\n    type: RESTAR_GAME_SUCCESS,\n    gameId: data.game_id.$oid,\n    gameStatus: data.game_status\n  }\n}\n\nexport function switchFlag(coordinates, validateCellStatus, cell, props) {\n  console.log(\"estamos en la funcion switchFlag\");\n  console.log(coordinates)\n  console.log(validateCellStatus)\n  console.log(cell)\n  return function(dispatch) {\n    let data = {\n      coordinates: coordinates\n    }\n    fetch('/game/flag', {\n      method: 'POST',\n      body: JSON.stringify(data),\n      headers: {'Content-Type': 'application/json' }\n    })\n    .then(response => response.json())\n    .then(data => {\n      validateCellStatus(cell, data, props)\n      console.log(\"respuesta del estado de la celda:\")\n      console.log(data.cell_status);\n      dispatch(flagSuccess(data.cell_status));\n    })\n    .catch(error => console.log('error', error));\n  }\n}\n\nfunction flagSuccess(response) {\n  console.log(\"se obtuvo el valor de la celda:\");\n  console.log(response);\n  return {\n    type: CELL_STATUS,\n    cellStatus: response\n  };\n}\n\nexport function knowTheGameState(gameStatus) {\n  if (gameStatus == 3) {\n    console.log(\"Estamos en un juego nuevo, obtener el Id para ir guardando los cambios\")\n    return function(dispatch) {\n      fetch('/game/get/id')\n      .then(response => response.json())\n      .then(data =>{\n        console.log(data);\n        dispatch(gameIdSuccess(data));\n      });\n    }\n\n  } else {\n    if (gameStatus == 0) {\n      console.log(\"ya se estaba jugando, restaurar el tablero guardado\")\n    } else {\n      if (gameStatus == 1) {\n        console.log(\"El jugador ha perdido\")\n      } else {\n        if (gameStatus == 2) {\n          console.log(\"El jugador ha ganado\")\n        }\n      }\n    }\n  }\n  return {\n    type: NOTHING\n  }\n}\n\nfunction gameIdSuccess(data) {\n  console.log(\"llegamos a GAMEIDSUCCESS\")\n  return {\n    type: GAME_ID_STATUS,\n    gameId: data.game_id.$oid,\n    gameStatus: data.game_status\n  }\n}\n\nexport function getStatusGame (props) {\n  console.log(\"Estamos en la funcion getStatusGame\")\n  console.log(props)\n  return {\n    type: GAME_STATUS_SUCCESS,\n    data: props   //AUN NO SE HA ESCRITO LA RESPUESTA EN STATES.JS\n  }\n}\n\nexport function markTheBoard (gameId, coordinates) {\n  console.log(\"llegamos a markTheBoard\")\n  return function(dispatch) {\n    let data = {\n      gameId: gameId,\n      coordinates: coordinates\n    }\n    fetch('/game/push/flag', {\n      method: 'POST',\n      body: JSON.stringify(data),\n      headers: {'Content-Type': 'application/json' }\n    })\n    .then(response => response.json())\n    .then(data => {\n      console.log(\"respuesta del estado de la celda:\")\n      console.log(data)\n      console.log(data.game_status);\n      dispatch(markBoardSuccess(data.game_status));\n    })\n    .catch(error => console.log('error', error));\n  }\n}\n\nfunction markBoardSuccess (gameStatus) {\n  console.log(\"llegamos a markBoardSuccess\")\n  return {\n    type: PUT_FLAG,\n    gameStatus: gameStatus\n  }\n}"]},"metadata":{},"sourceType":"module"}